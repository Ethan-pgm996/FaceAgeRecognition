## 思路

考虑到直接进行70分类的难度较高，我们将分类任务划分成了两个阶段。

- 阶段1 年龄段训练

我们使用了VGGFace预训练的权重进行了基于年龄段分类的权重微调。即

|年龄段|标签|年龄段|标签|
|-|-|-|-|
|1-10|1|41-50|5|
|11-20|2|51-60|6|
|21-30|3|61-70|7|
|31-40|4|

第一阶段预训练的结果大约在百分之八十的正确率。

- 阶段2 精确年龄训练

从第二阶段开始，我们开始在上阶段训练的基础上进行新一轮的权重微调。即7分类到70分类的任务转换。

在两个阶段中，我们另外引入了新的损失函数用来减少模型分错的概率。

$dist = ||y_{pred} - y_{true}||_2$

之所以在交叉熵函数的前提下又加入了新的损失函数，是因为我们认为年龄分类问题不同于一般的分类问题。首先应该保证的是模型能够大概估计样本的年龄段再进行分类，但是交叉熵损失是基于one-hot编码进行计算了，不同类间样本的距离总是1，与真实世界不符。在引入了该损失之后，我们观察到模型预测的样本中错把六十岁分成1岁或2岁的情况大量减少了。

除此之外，数据增广在提高分类正确率上起到了非常关键的作用。

